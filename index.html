<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panda Wedding Budget Planner</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  
  :root {
    --pastel-blue: #a8d0e6;
    --pastel-lavender: #d8c6f7;
    --pastel-pink: #f8c6d8;
    --pastel-green: #c7f0d8;
    --pastel-yellow: #f8e9a1;
    --navy: #374785;
    --light: #f8f9ff;
    --text: #2b2d42;
    --accent: #f76c6c;
    --dark-mode-bg: #121826;
    --dark-mode-card: #1e293b;
    --dark-mode-text: #e2e8f0;
  }
  
  body {
    background: linear-gradient(135deg, #f8f9ff 0%, #e6f0ff 100%);
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
    padding: 20px;
    position: relative;
    overflow-x: hidden;
    transition: background 0.5s ease;
  }

  body.dark-mode {
    background: linear-gradient(135deg, var(--dark-mode-bg) 0%, #0f172a 100%);
    color: var(--dark-mode-text);
  }
  
  /* Panda decoration */
  .panda-decoration {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 120px;
    height: 120px;
    z-index: 0;
    opacity: 0.1;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="60" cy="60" r="40" fill="white"/><circle cx="140" cy="60" r="40" fill="white"/><circle cx="50" cy="50" r="10" fill="black"/><circle cx="150" cy="50" r="10" fill="black"/><ellipse cx="100" cy="120" rx="40" ry="30" fill="white"/><path d="M80 100 Q100 90 120 100" stroke="black" stroke-width="3" fill="none"/><circle cx="100" cy="130" r="5" fill="black"/></svg>');
    background-repeat: no-repeat;
    background-size: contain;
    transition: opacity 0.3s;
  }

  body.dark-mode .panda-decoration {
    opacity: 0.15;
  }
  
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    position: relative;
    z-index: 1;
    border: 1px solid rgba(0,0,0,0.05);
    transition: all 0.5s ease;
    animation: fadeIn 0.8s ease-out;
  }

  body.dark-mode .container {
    background: var(--dark-mode-card);
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    border-color: rgba(255,255,255,0.05);
  }
  
  header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    position: relative;
    animation: slideInDown 0.7s ease-out;
  }
  
  .logo {
    font-size: 3.5rem;
    color: var(--navy);
    margin-bottom: 15px;
  }

  body.dark-mode .logo {
    color: var(--pastel-green);
  }
  
  header h1 {
    font-size: 2.8rem;
    color: var(--navy);
    margin-bottom: 15px;
    font-weight: 700;
  }

  body.dark-mode header h1 {
    color: var(--pastel-green);
  }
  
  .header-subtitle {
    color: var(--navy);
    font-size: 1.2rem;
    max-width: 600px;
    margin: 0 auto;
    font-weight: 300;
    opacity: 0.8;
  }

  body.dark-mode .header-subtitle {
    color: var(--dark-mode-text);
  }
  
  .data-controls {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
    flex-wrap: wrap;
  }
  
  .data-btn {
    padding: 10px 20px;
    font-size: 0.9rem;
    background: var(--pastel-blue);
    color: var(--navy);
    border: none;
    border-radius: 30px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 500;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }

  body.dark-mode .data-btn {
    background: rgba(55, 71, 133, 0.3);
    color: var(--dark-mode-text);
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  }
  
  .data-btn:hover {
    background: var(--navy);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }

  body.dark-mode .data-btn:hover {
    background: var(--pastel-green);
    color: var(--dark-mode-bg);
  }
  
  .form-container {
    background: var(--light);
    border-radius: 16px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.03);
    transition: all 0.3s;
    animation: zoomIn 0.6s ease-out;
  }

  body.dark-mode .form-container {
    background: rgba(30, 41, 59, 0.5);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  
  .form-title {
    color: var(--navy);
    margin-bottom: 20px;
    font-size: 1.4rem;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  body.dark-mode .form-title {
    color: var(--pastel-green);
  }
  
  form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
  }
  
  .form-group {
    margin-bottom: 20px;
    position: relative;
  }
  
  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--navy);
    font-size: 0.95rem;
    opacity: 0.9;
  }

  body.dark-mode label {
    color: var(--pastel-blue);
  }
  
  input, select {
    width: 100%;
    padding: 14px 18px;
    font-size: 1rem;
    background: white;
    color: var(--text);
    border: 2px solid var(--pastel-blue);
    border-radius: 12px;
    transition: all 0.3s ease;
  }

  body.dark-mode input, 
  body.dark-mode select {
    background: rgba(30, 41, 59, 0.7);
    color: var(--dark-mode-text);
    border-color: var(--navy);
  }
  
  input:focus, select:focus {
    border-color: var(--navy);
    outline: none;
    box-shadow: 0 0 0 3px rgba(55, 71, 133, 0.1);
  }

  body.dark-mode input:focus,
  body.dark-mode select:focus {
    border-color: var(--pastel-green);
    box-shadow: 0 0 0 3px rgba(199, 240, 216, 0.2);
  }
  
  button {
    padding: 16px 25px;
    font-size: 1rem;
    background: var(--pastel-pink);
    color: var(--navy);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }

  body.dark-mode button {
    background: var(--pastel-green);
    color: var(--dark-mode-bg);
  }
  
  button:hover {
    background: var(--navy);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }

  body.dark-mode button:hover {
    background: var(--pastel-blue);
    color: var(--dark-mode-bg);
  }
  
  table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    font-size: 0.95rem;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.03);
    background: white;
    margin-bottom: 30px;
    animation: fadeInUp 0.8s ease-out;
  }

  body.dark-mode table {
    background: rgba(30, 41, 59, 0.5);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  
  thead tr {
    background: var(--pastel-lavender);
    color: var(--navy);
  }

  body.dark-mode thead tr {
    background: rgba(55, 71, 133, 0.4);
  }
  
  th {
    padding: 18px 20px;
    text-align: left;
    font-weight: 600;
    color: var(--navy);
  }

  body.dark-mode th {
    color: var(--dark-mode-text);
  }
  
  tr.acara-header {
    background: var(--pastel-green);
    font-weight: 700;
    cursor: move;
    user-select: none;
    position: relative;
    transition: background 0.3s;
  }

  body.dark-mode tr.acara-header {
    background: rgba(199, 240, 216, 0.15);
  }
  
  tr.acara-header:hover {
    background: #bce8d0;
  }

  body.dark-mode tr.acara-header:hover {
    background: rgba(199, 240, 216, 0.25);
  }
  
  tr.acara-header.dragging {
    opacity: 0.7;
    background: var(--pastel-green);
  }
  
  tr.perlengkapan-row {
    background: white;
    transition: background 0.3s;
    cursor: move;
    border-bottom: 1px solid rgba(0,0,0,0.05);
  }

  body.dark-mode tr.perlengkapan-row {
    background: rgba(30, 41, 59, 0.3);
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }
  
  tr.perlengkapan-row:hover {
    background: #f8f9ff;
  }

  body.dark-mode tr.perlengkapan-row:hover {
    background: rgba(55, 71, 133, 0.2);
  }
  
  tr.perlengkapan-row.dragging {
    opacity: 0.7;
    background: #f0f4ff;
  }

  body.dark-mode tr.perlengkapan-row.dragging {
    background: rgba(55, 71, 133, 0.3);
  }
  
  .drop-target {
    background: rgba(168, 208, 230, 0.3) !important;
  }
  
  td {
    padding: 16px 20px;
    text-align: left;
  }
  
  td[contenteditable="true"] {
    background-color: rgba(168, 208, 230, 0.15);
    border-radius: 8px;
    cursor: text;
    transition: background 0.3s;
  }

  body.dark-mode td[contenteditable="true"] {
    background-color: rgba(55, 71, 133, 0.2);
  }
  
  td[contenteditable="true"]:focus {
    background-color: rgba(168, 208, 230, 0.25);
    outline: 2px solid var(--pastel-blue);
  }

  body.dark-mode td[contenteditable="true"]:focus {
    background-color: rgba(55, 71, 133, 0.3);
    outline: 2px solid var(--pastel-blue);
  }
  
  .remove-btn {
    background: rgba(247, 108, 108, 0.15);
    border: none;
    color: var(--accent);
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  body.dark-mode .remove-btn {
    background: rgba(247, 108, 108, 0.2);
  }
  
  .remove-btn:hover {
    background: var(--accent);
    color: white;
    transform: translateY(-2px);
  }
  
  .remove-acara-btn {
    background: rgba(247, 108, 108, 0.15);
    border: none;
    color: var(--accent);
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  body.dark-mode .remove-acara-btn {
    background: rgba(247, 108, 108, 0.2);
  }
  
  .remove-acara-btn:hover {
    background: var(--accent);
    color: white;
    transform: translateY(-2px);
  }
  
  .total-row {
    font-weight: 700;
    background: var(--pastel-yellow);
    text-align: right;
    font-size: 1.1rem;
  }

  body.dark-mode .total-row {
    background: rgba(248, 233, 161, 0.2);
  }
  
  .total-row td:last-child {
    font-weight: 800;
    color: var(--navy);
    font-size: 1.3rem;
  }

  body.dark-mode .total-row td:last-child {
    color: var(--pastel-yellow);
  }
  
  .acara-name {
    font-weight: 700;
    color: var(--navy);
    font-size: 1.1rem;
  }

  body.dark-mode .acara-name {
    color: var(--pastel-green);
  }
  
  .acara-total {
    font-size: 0.95rem;
    color: var(--navy);
    font-weight: 600;
    background: rgba(55, 71, 133, 0.1);
    padding: 6px 12px;
    border-radius: 20px;
    display: inline-flex;
    margin-left: 15px;
  }

  body.dark-mode .acara-total {
    color: var(--pastel-blue);
    background: rgba(55, 71, 133, 0.3);
  }
  
  .acara-schedule {
    font-size: 0.9rem;
    color: var(--navy);
    display: flex;
    gap: 15px;
    margin-top: 10px;
  }

  body.dark-mode .acara-schedule {
    color: var(--pastel-blue);
  }
  
  .schedule-input {
    background: white;
    border: 2px solid var(--pastel-blue);
    color: var(--navy);
    padding: 8px 12px;
    width: 160px;
    font-size: 0.9rem;
    border-radius: 10px;
  }

  body.dark-mode .schedule-input {
    background: rgba(30, 41, 59, 0.5);
    border-color: var(--navy);
    color: var(--dark-mode-text);
  }
  
  .schedule-input:focus {
    outline: none;
    border-color: var(--navy);
  }

  body.dark-mode .schedule-input:focus {
    border-color: var(--pastel-green);
  }
  
  .empty-table {
    text-align: center;
    padding: 50px;
    color: var(--navy);
    opacity: 0.6;
  }

  body.dark-mode .empty-table {
    color: var(--dark-mode-text);
  }
  
  .empty-table i {
    font-size: 3.5rem;
    color: var(--pastel-blue);
    margin-bottom: 15px;
  }

  body.dark-mode .empty-table i {
    color: var(--pastel-green);
  }
  
  .empty-table h3 {
    color: var(--navy);
    margin-bottom: 10px;
    font-weight: 600;
  }

  body.dark-mode .empty-table h3 {
    color: var(--pastel-green);
  }
  
  .tip-section {
    margin-top: 30px;
    padding: 25px;
    background: var(--pastel-lavender);
    border-radius: 16px;
    display: flex;
    gap: 20px;
    animation: fadeIn 0.8s ease-out;
  }

  body.dark-mode .tip-section {
    background: rgba(55, 71, 133, 0.2);
  }
  
  .tip-icon {
    font-size: 2rem;
    color: var(--navy);
    flex-shrink: 0;
    background: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  body.dark-mode .tip-icon {
    background: rgba(30, 41, 59, 0.8);
    color: var(--pastel-green);
  }
  
  .tip-content h3 {
    color: var(--navy);
    margin-bottom: 12px;
    font-size: 1.3rem;
  }

  body.dark-mode .tip-content h3 {
    color: var(--pastel-green);
  }
  
  .tip-content p {
    color: var(--text);
    opacity: 0.9;
    line-height: 1.7;
  }

  body.dark-mode .tip-content p {
    color: var(--dark-mode-text);
  }
  
  .summary-boxes {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
    animation: fadeIn 0.8s ease-out;
  }
  
  .summary-box {
    background: white;
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    text-align: center;
    transition: transform 0.3s ease;
    border: 2px solid var(--pastel-blue);
  }

  body.dark-mode .summary-box {
    background: rgba(30, 41, 59, 0.5);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    border-color: var(--navy);
  }
  
  .summary-box:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
  }
  
  .summary-box i {
    font-size: 2.5rem;
    color: var(--navy);
    margin-bottom: 15px;
    background: var(--pastel-yellow);
    width: 70px;
    height: 70px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    transition: all 0.3s ease;
  }

  body.dark-mode .summary-box i {
    background: rgba(248, 233, 161, 0.2);
    color: var(--pastel-yellow);
  }
  
  .summary-box h3 {
    color: var(--navy);
    margin-bottom: 10px;
    font-size: 1.1rem;
    font-weight: 600;
  }

  body.dark-mode .summary-box h3 {
    color: var(--pastel-green);
  }
  
  .summary-box .value {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--navy);
  }

  body.dark-mode .summary-box .value {
    color: var(--pastel-blue);
  }
  
  .notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 16px 26px;
    background: white;
    color: var(--navy);
    border-radius: 12px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    transform: translateX(200%);
    transition: transform 0.3s ease;
    z-index: 1000;
    display: flex;
    align-items: center;
    gap: 12px;
    border-left: 4px solid var(--pastel-green);
  }

  body.dark-mode .notification {
    background: var(--dark-mode-card);
    color: var(--dark-mode-text);
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
  }
  
  .notification.show {
    transform: translateX(0);
  }
  
  .notification.error {
    border-left-color: var(--accent);
  }
  
  .drag-hint {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    color: var(--navy);
    padding: 12px 25px;
    border-radius: 30px;
    font-size: 0.9rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 10px;
    border: 2px solid var(--pastel-blue);
    animation: pulse 2s infinite;
  }

  body.dark-mode .drag-hint {
    background: var(--dark-mode-card);
    color: var(--dark-mode-text);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    border-color: var(--navy);
  }
  
  /* Login screen */
  .login-container {
    max-width: 450px;
    margin: 100px auto;
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.15);
    text-align: center;
    animation: fadeIn 0.8s ease-out;
    position: relative;
    overflow: hidden;
  }

  body.dark-mode .login-container {
    background: var(--dark-mode-card);
    box-shadow: 0 15px 40px rgba(0,0,0,0.3);
  }
  
  .login-container::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 8px;
    background: linear-gradient(90deg, var(--pastel-pink), var(--pastel-blue), var(--pastel-green));
  }
  
  .login-logo {
    font-size: 4.5rem;
    color: var(--navy);
    margin-bottom: 20px;
    animation: bounceIn 1s ease-out;
  }

  body.dark-mode .login-logo {
    color: var(--pastel-green);
  }
  
  .login-title {
    font-size: 2.2rem;
    color: var(--navy);
    margin-bottom: 10px;
    font-weight: 700;
  }

  body.dark-mode .login-title {
    color: var(--pastel-green);
  }
  
  .login-subtitle {
    color: var(--navy);
    font-size: 1rem;
    margin-bottom: 30px;
    opacity: 0.8;
  }

  body.dark-mode .login-subtitle {
    color: var(--dark-mode-text);
  }
  
  .login-btn {
    padding: 16px 30px;
    font-size: 1.1rem;
    background: var(--pastel-green);
    color: var(--navy);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }

  body.dark-mode .login-btn {
    background: var(--pastel-green);
    color: var(--dark-mode-bg);
  }
  
  .login-btn:hover {
    background: var(--navy);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }

  body.dark-mode .login-btn:hover {
    background: var(--pastel-blue);
    color: var(--dark-mode-bg);
  }
  
  .theme-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: var(--pastel-lavender);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    z-index: 1000;
    transition: all 0.3s ease;
  }

  body.dark-mode .theme-toggle {
    background: var(--pastel-blue);
  }
  
  .theme-toggle:hover {
    transform: rotate(15deg) scale(1.1);
  }
  
  .theme-toggle i {
    font-size: 1.4rem;
    color: var(--navy);
  }

  body.dark-mode .theme-toggle i {
    color: var(--dark-mode-text);
  }
  
  .user-info {
    position: absolute;
    top: 20px;
    left: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
    background: rgba(199, 240, 216, 0.3);
    padding: 8px 16px;
    border-radius: 30px;
    font-size: 0.9rem;
    font-weight: 500;
  }

  body.dark-mode .user-info {
    background: rgba(55, 71, 133, 0.3);
  }
  
  .logout-btn {
    background: none;
    border: none;
    color: var(--accent);
    cursor: pointer;
    font-size: 1.1rem;
    transition: all 0.3s ease;
    padding: 5px;
  }
  
  .logout-btn:hover {
    transform: rotate(15deg);
  }

  /* Status button */
  .status-btn {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 0 auto;
    display: block;
    border: none;
  }

  .status-btn.not-ready {
    background: #f76c6c; /* Red */
    box-shadow: 0 0 8px rgba(247, 108, 108, 0.5);
  }

  .status-btn.ready {
    background: #4CAF50; /* Green */
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.5);
  }

  body.dark-mode .status-btn.not-ready {
    background: #e53e3e;
  }

  body.dark-mode .status-btn.ready {
    background: #38a169;
  }

  .add-perlengkapan-btn {
    background: rgba(55, 71, 133, 0.1);
    border: none;
    color: var(--navy);
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 10px;
  }

  body.dark-mode .add-perlengkapan-btn {
    background: rgba(55, 71, 133, 0.3);
    color: var(--dark-mode-text);
  }
  
  .add-perlengkapan-btn:hover {
    background: var(--pastel-blue);
    color: var(--navy);
  }

  body.dark-mode .add-perlengkapan-btn:hover {
    background: var(--pastel-green);
    color: var(--dark-mode-bg);
  }
  
  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes slideInDown {
    from {
      transform: translateY(-50px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  
  @keyframes zoomIn {
    from {
      transform: scale(0.95);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
  
  @keyframes bounceIn {
    0% {
      transform: scale(0.5);
      opacity: 0;
    }
    60% {
      transform: scale(1.1);
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }
  
  @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(168, 208, 230, 0.4); }
    70% { box-shadow: 0 0 0 10px rgba(168, 208, 230, 0); }
    100% { box-shadow: 0 0 0 0 rgba(168, 208, 230, 0); }
  }

  body.dark-mode .drag-hint {
    animation: pulseDark 2s infinite;
  }
  
  @keyframes pulseDark {
    0% { box-shadow: 0 0 0 0 rgba(55, 71, 133, 0.4); }
    70% { box-shadow: 0 0 0 10px rgba(55, 71, 133, 0); }
    100% { box-shadow: 0 0 0 0 rgba(55, 71, 133, 0); }
  }
  
  @media (max-width: 992px) {
    .acara-schedule {
      flex-direction: column;
      gap: 8px;
    }
    
    .acara-header td {
      padding-bottom: 30px;
    }
    
    header h1 {
      font-size: 2.2rem;
    }
  }
  
  @media (max-width: 768px) {
    form {
      grid-template-columns: 1fr;
    }
    
    .container {
      padding: 20px;
    }
    
    .summary-boxes {
      grid-template-columns: 1fr;
    }
    
    .drag-hint {
      top: 70px;
      font-size: 0.8rem;
      width: 90%;
      text-align: center;
    }
    
    .acara-schedule {
      flex-direction: row;
      flex-wrap: wrap;
    }
    
    .schedule-input {
      width: 100%;
    }
    
    .tip-section {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
  }
</style>
</head>
<body>
  <!-- Panda decoration -->
  <div class="panda-decoration"></div>

  <!-- Theme toggle -->
  <div class="theme-toggle" id="themeToggle">
    <i class="fas fa-moon"></i>
  </div>

  <!-- Login Container (initially visible) -->
  <div class="login-container" id="loginContainer">
    <div class="login-logo">
      <i class="fas fa-paw"></i>
    </div>
    <h1 class="login-title">Panda Wedding Planner</h1>
    <p class="login-subtitle">Klik tombol di bawah untuk mulai mengelola anggaran pernikahan Anda</p>
    
    <button class="login-btn" id="loginBtn">
      <i class="fas fa-sign-in-alt"></i> Masuk
    </button>
  </div>

  <!-- Main Application (initially hidden) -->
  <div class="main-app" id="mainApp" style="display: none;">
    <div class="drag-hint">
      <i class="fas fa-arrows-alt"></i> Drag & Drop untuk mengurutkan acara dan perlengkapan
    </div>
    
    <div class="container">
      <div class="user-info">
        <span id="userName">pandajawa</span>
        <button class="logout-btn" id="logoutBtn" title="Keluar">
          <i class="fas fa-sign-out-alt"></i>
        </button>
      </div>
      
      <header>
        <div class="logo">
          <i class="fas fa-paw"></i>
        </div>
        <h1>Panda Wedding Planner</h1>
        <p class="header-subtitle">kita usahakan rumah itu</p>
        
        <div class="data-controls">
          <button class="data-btn" id="saveDataBtn">
            <i class="fas fa-save"></i> Simpan Data
          </button>
          <button class="data-btn" id="loadDataBtn">
            <i class="fas fa-folder-open"></i> Muat Data
          </button>
          <button class="data-btn" id="resetDataBtn">
            <i class="fas fa-trash"></i> Reset Data
          </button>
          <button class="data-btn" id="exportPdfBtn">
            <i class="fas fa-file-pdf"></i> Export PDF
          </button>
          <!-- Tombol baru untuk export Excel -->
          <button class="data-btn" id="exportExcelBtn">
            <i class="fas fa-file-excel"></i> Export Excel
          </button>
        </div>
      </header>
      
      <div class="summary-boxes">
        <div class="summary-box">
          <i class="fas fa-calendar-alt"></i>
          <h3>Total Acara</h3>
          <div class="value" id="totalEvents">0</div>
        </div>
        <div class="summary-box">
          <i class="fas fa-gift"></i>
          <h3>Total Perlengkapan</h3>
          <div class="value" id="totalPerlengkapan">0</div>
        </div>
        <div class="summary-box">
          <i class="fas fa-money-bill-wave"></i>
          <h3>Total Anggaran</h3>
          <div class="value" id="previewTotalAmount">Rp 0</div>
        </div>
      </div>
      
      <div class="form-container">
        <h2 class="form-title"><i class="fas fa-plus-circle"></i> Tambah Perlengkapan</h2>
        <form id="addPerlengkapanForm" autocomplete="off">
          <div class="form-group">
            <label for="acaraInput"><i class="fas fa-calendar"></i> Acara Utama</label>
            <input list="acaraList" type="text" id="acaraInput" placeholder="Akad Nikah, Resepsi, dll" required />
            <datalist id="acaraList">
              <option value="Akad Nikah">
              <option value="Resepsi">
              <option value="Pre-Wedding">
              <option value="Honeymoon">
              <option value="Dekorasi">
              <option value="Catering">
              <option value="Fotografi">
              <option value="Pakaian">
              <option value="Souvenir">
            </datalist>
          </div>
          
          <div class="form-group">
            <label for="perlengkapanInput"><i class="fas fa-gift"></i> Perlengkapan</label>
            <input type="text" id="perlengkapanInput" placeholder="Gaun pengantin, Makeup, dll" required />
          </div>
          
          <div class="form-group">
            <label for="quantityInput"><i class="fas fa-cubes"></i> Jumlah</label>
            <input type="number" id="quantityInput" placeholder="Jumlah barang" min="1" required />
          </div>
          
          <div class="form-group">
            <label for="amountInput"><i class="fas fa-money-bill"></i> Biaya (Rp)</label>
            <input type="number" id="amountInput" placeholder="Jumlah biaya" min="0" required />
          </div>
          
          <div class="form-group">
            <label for="eventDate"><i class="fas fa-calendar-day"></i> Tanggal Acara</label>
            <input type="date" id="eventDate" required />
          </div>
          
          <div class="form-group">
            <label for="eventTime"><i class="fas fa-clock"></i> Waktu Acara</label>
            <input type="time" id="eventTime" required />
          </div>
          
          <div class="form-group">
            <label>&nbsp;</label>
            <button type="submit"><i class="fas fa-plus"></i> Tambah Perlengkapan</button>
          </div>
        </form>
      </div>

      <table id="budgetTable" aria-label="Daftar Anggaran Pernikahan">
        <thead>
          <tr>
            <th>Acara / Perlengkapan</th>
            <th>Jadwal</th>
            <th>Jumlah Barang</th>
            <th>Biaya (Rp)</th>
            <th>Status</th> <!-- Kolom baru -->
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr class="empty-table-row">
            <td colspan="6">
              <div class="empty-table">
                <i class="fas fa-receipt"></i>
                <h3>Belum ada data anggaran</h3>
                <p>Mulai tambahkan acara dan perlengkapan pernikahan Anda</p>
              </div>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="total-row">
            <td colspan="4">Total Keseluruhan</td>
            <td id="totalAmount">Rp 0</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
      
      <div class="tip-section">
        <div class="tip-icon">
          <i class="fas fa-lightbulb"></i>
        </div>
        <div class="tip-content">
          <h3>Tips Menghemat Anggaran Pernikahan</h3>
          <p>1. Pilih hari kerja untuk resepsi bisa menghemat hingga 30% biaya venue dan vendor.<br>
             2. Batasi jumlah tamu undangan untuk mengurangi biaya catering dan souvenir.<br>
             3. Buat souvenir sederhana namun bermakna dengan sentuhan personal.<br>
             4. Bandingkan harga dari beberapa vendor sebelum memutuskan.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span>Data berhasil disimpan!</span>
  </div>

  <!-- Library untuk export Excel -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  
  <script>
    (() => {
      // Data struktur
      const acaraList = [];
      const STORAGE_KEY = 'panda_wedding_data_';
      let currentUser = null;
      
      // DOM Elements
      const loginContainer = document.getElementById('loginContainer');
      const mainApp = document.getElementById('mainApp');
      const loginBtn = document.getElementById('loginBtn');
      const logoutBtn = document.getElementById('logoutBtn');
      const userNameEl = document.getElementById('userName');
      const form = document.getElementById('addPerlengkapanForm');
      const acaraInput = document.getElementById('acaraInput');
      const acaraDatalist = document.getElementById('acaraList');
      const perlengkapanInput = document.getElementById('perlengkapanInput');
      const quantityInput = document.getElementById('quantityInput');
      const amountInput = document.getElementById('amountInput');
      const eventDateInput = document.getElementById('eventDate');
      const eventTimeInput = document.getElementById('eventTime');
      const tbody = document.getElementById('tableBody');
      const totalAmountTd = document.getElementById('totalAmount');
      const totalEventsEl = document.getElementById('totalEvents');
      const totalPerlengkapanEl = document.getElementById('totalPerlengkapan');
      const previewTotalAmount = document.getElementById('previewTotalAmount');
      const notification = document.getElementById('notification');
      const saveDataBtn = document.getElementById('saveDataBtn');
      const loadDataBtn = document.getElementById('loadDataBtn');
      const resetDataBtn = document.getElementById('resetDataBtn');
      const exportPdfBtn = document.getElementById('exportPdfBtn');
      const exportExcelBtn = document.getElementById('exportExcelBtn');
      const themeToggle = document.getElementById('themeToggle');

      // Format mata uang Rupiah
      function formatRupiah(number) {
        return new Intl.NumberFormat('id-ID', { 
          style: 'currency', 
          currency: 'IDR',
          maximumFractionDigits: 0
        }).format(number);
      }

      // Tampilkan notifikasi
      function showNotification(message, isError = false) {
        notification.innerHTML = `<i class="fas fa-${isError ? 'exclamation-circle' : 'check-circle'}"></i> <span>${message}</span>`;
        notification.className = isError ? 'notification error' : 'notification';
        notification.classList.add('show');
        
        setTimeout(() => {
          notification.classList.remove('show');
        }, 3000);
      }

      // Simpan data ke localStorage
      function saveData() {
        if (!currentUser) return;
        
        try {
          const data = {
            acaraList: acaraList,
            timestamp: new Date().toISOString()
          };
          localStorage.setItem(STORAGE_KEY + currentUser, JSON.stringify(data));
          showNotification('Data berhasil disimpan!');
        } catch (e) {
          showNotification('Gagal menyimpan data: ' + e.message, true);
        }
      }

      // Muat data dari localStorage
      function loadData() {
        if (!currentUser) return;
        
        try {
          const savedData = localStorage.getItem(STORAGE_KEY + currentUser);
          if (savedData) {
            const parsedData = JSON.parse(savedData);
            acaraList.length = 0; // Clear existing data
            
            // Add loaded data
            parsedData.acaraList.forEach(item => {
              acaraList.push(item);
            });
            
            renderTable();
            showNotification('Data berhasil dimuat!');
          } else {
            showNotification('Tidak ada data yang tersimpan', true);
          }
        } catch (e) {
          showNotification('Gagal memuat data: ' + e.message, true);
        }
      }

      // Reset semua data
      function resetData() {
        if (confirm('Apakah Anda yakin ingin menghapus semua data? Data tidak dapat dikembalikan.')) {
          acaraList.length = 0;
          renderTable();
          localStorage.removeItem(STORAGE_KEY + currentUser);
          showNotification('Semua data telah direset');
        }
      }

      // Update ringkasan kotak
      function updateSummaryBoxes() {
        const totalEvents = acaraList.length;
        let totalPerlengkapan = 0;
        let totalAmount = 0;
        
        acaraList.forEach(acara => {
          totalPerlengkapan += acara.perlengkapan.length;
          acara.perlengkapan.forEach(item => {
            totalAmount += item.amount;
          });
        });
        
        totalEventsEl.textContent = totalEvents;
        totalPerlengkapanEl.textContent = totalPerlengkapan;
        previewTotalAmount.textContent = formatRupiah(totalAmount);
        totalAmountTd.textContent = formatRupiah(totalAmount);
      }

      // Fungsi drag and drop
      function handleDragStart(e) {
        this.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
        e.dataTransfer.setData('text/plain', this.dataset.type + '|' + this.dataset.index);
      }

      function handleDragOver(e) {
        e.preventDefault();
        if (this !== dragSrc && this.classList.contains('acara-header')) {
          this.classList.add('drop-target');
        }
        return false;
      }

      function handleDragLeave() {
        this.classList.remove('drop-target');
      }

      function handleDrop(e) {
        e.stopPropagation();
        this.classList.remove('drop-target');
        
        const data = e.dataTransfer.getData('text/plain').split('|');
        const srcType = data[0];
        const srcIndex = parseInt(data[1]);
        
        if (this.classList.contains('acara-header')) {
          const tgtIndex = parseInt(this.dataset.index);
          
          if (srcType === 'acara') {
            // Pindahkan acara
            const moved = acaraList.splice(srcIndex, 1)[0];
            acaraList.splice(tgtIndex, 0, moved);
            saveData();
            renderTable();
          }
        } else if (this.classList.contains('perlengkapan-row')) {
          const srcAcaraIndex = parseInt(this.dataset.acaraIndex);
          const tgtAcaraIndex = parseInt(this.dataset.acaraIndex);
          const tgtPerlengkapanIndex = parseInt(this.dataset.perlengkapanIndex);
          
          if (srcType === 'perlengkapan') {
            if (srcAcaraIndex === tgtAcaraIndex) {
              // Pindahkan perlengkapan dalam acara yang sama
              const perlengkapan = acaraList[srcAcaraIndex].perlengkapan;
              const moved = perlengkapan.splice(srcIndex, 1)[0];
              perlengkapan.splice(tgtPerlengkapanIndex, 0, moved);
              saveData();
              renderTable();
            } else {
              // Pindahkan perlengkapan ke acara lain
              const srcItem = acaraList[srcAcaraIndex].perlengkapan.splice(srcIndex, 1)[0];
              acaraList[tgtAcaraIndex].perlengkapan.splice(tgtPerlengkapanIndex, 0, srcItem);
              saveData();
              renderTable();
            }
          }
        }
        
        return false;
      }

      function handleDragEnd() {
        this.classList.remove('dragging');
      }

      // Render tabel dengan data acara
      function renderTable() {
        // Cek jika tidak ada acara
        if (acaraList.length === 0) {
          tbody.innerHTML = `
            <tr class="empty-table-row">
              <td colspan="6">
                <div class="empty-table">
                  <i class="fas fa-receipt"></i>
                  <h3>Belum ada data anggaran</h3>
                  <p>Mulai tambahkan acara dan perlengkapan pernikahan Anda</p>
                </div>
              </td>
            </tr>
          `;
          updateSummaryBoxes();
          return;
        }
        
        tbody.innerHTML = '';
        
        acaraList.forEach((acara, acaraIndex) => {
          // Baris acara header
          const trAcara = document.createElement('tr');
          trAcara.classList.add('acara-header');
          trAcara.dataset.index = acaraIndex;
          trAcara.dataset.type = 'acara';
          trAcara.setAttribute('draggable', 'true');

          const tdAcara = document.createElement('td');
          tdAcara.colSpan = 6;
          tdAcara.style.userSelect = 'none';
          tdAcara.style.position = 'relative';
          tdAcara.style.padding = '18px 20px';

          const acaraNameSpan = document.createElement('span');
          acaraNameSpan.contentEditable = "true";
          acaraNameSpan.textContent = acara.name;
          acaraNameSpan.classList.add('acara-name');
          acaraNameSpan.title = "Klik untuk edit nama acara";
          acaraNameSpan.addEventListener('blur', () => {
            const val = acaraNameSpan.textContent.trim();
            if (!val) {
              alert('Nama acara tidak boleh kosong');
              acaraNameSpan.textContent = acara.name;
              return;
            }
            acara.name = val;
            saveData();
            updateSummaryBoxes();
          });
          tdAcara.appendChild(acaraNameSpan);
          
          // Total biaya acara
          const totalAcara = acara.perlengkapan.reduce((sum, item) => sum + item.amount, 0);
          const totalSpan = document.createElement('span');
          totalSpan.classList.add('acara-total');
          totalSpan.textContent = `Total: ${formatRupiah(totalAcara)}`;
          tdAcara.appendChild(totalSpan);
          
          // Jadwal acara
          const scheduleDiv = document.createElement('div');
          scheduleDiv.classList.add('acara-schedule');
          
          const dateInput = document.createElement('input');
          dateInput.type = 'date';
          dateInput.className = 'schedule-input';
          dateInput.value = acara.date || '';
          dateInput.addEventListener('change', () => {
            acara.date = dateInput.value;
            saveData();
          });
          
          const timeInput = document.createElement('input');
          timeInput.type = 'time';
          timeInput.className = 'schedule-input';
          timeInput.value = acara.time || '12:00';
          timeInput.addEventListener('change', () => {
            acara.time = timeInput.value;
            saveData();
          });
          
          scheduleDiv.appendChild(dateInput);
          scheduleDiv.appendChild(timeInput);
          tdAcara.appendChild(scheduleDiv);

          // Tombol tambah perlengkapan
          const addPerlengkapanBtn = document.createElement('button');
          addPerlengkapanBtn.innerHTML = '<i class="fas fa-plus"></i> Tambah Perlengkapan';
          addPerlengkapanBtn.className = 'add-perlengkapan-btn';
          addPerlengkapanBtn.title = 'Tambah perlengkapan baru untuk acara ini';
          addPerlengkapanBtn.addEventListener('click', e => {
            e.stopPropagation();
            // Tambahkan perlengkapan kosong
            acara.perlengkapan.push({
              name: 'Perlengkapan Baru',
              quantity: 1,
              amount: 0,
              ready: false
            });
            saveData();
            renderTable();
          });
          tdAcara.appendChild(addPerlengkapanBtn);

          // Tombol hapus acara
          const btnRemoveAcara = document.createElement('button');
          btnRemoveAcara.innerHTML = '<i class="fas fa-trash"></i> Hapus Acara';
          btnRemoveAcara.className = 'remove-acara-btn';
          btnRemoveAcara.title = 'Hapus seluruh acara beserta perlengkapannya';
          btnRemoveAcara.addEventListener('click', e => {
            e.stopPropagation();
            if (confirm(`Hapus acara "${acara.name}" beserta semua perlengkapannya?`)) {
              acaraList.splice(acaraIndex, 1);
              saveData();
              renderTable();
            }
          });
          tdAcara.appendChild(btnRemoveAcara);

          trAcara.appendChild(tdAcara);
          tbody.appendChild(trAcara);

          // Tambahkan event listeners untuk drag and drop
          trAcara.addEventListener('dragstart', handleDragStart);
          trAcara.addEventListener('dragover', handleDragOver);
          trAcara.addEventListener('dragleave', handleDragLeave);
          trAcara.addEventListener('drop', handleDrop);
          trAcara.addEventListener('dragend', handleDragEnd);

          acara.perlengkapan.forEach((item, perlengkapanIndex) => {
            const trPerlengkapan = document.createElement('tr');
            trPerlengkapan.classList.add('perlengkapan-row');
            trPerlengkapan.dataset.acaraIndex = acaraIndex;
            trPerlengkapan.dataset.perlengkapanIndex = perlengkapanIndex;
            trPerlengkapan.dataset.index = perlengkapanIndex;
            trPerlengkapan.dataset.type = 'perlengkapan';
            trPerlengkapan.setAttribute('draggable', 'true');

            // Nama perlengkapan
            const tdPerlengkapanName = document.createElement('td');
            tdPerlengkapanName.style.paddingLeft = '30px';
            tdPerlengkapanName.contentEditable = "true";
            tdPerlengkapanName.textContent = item.name;
            tdPerlengkapanName.title = "Klik untuk edit perlengkapan";
            tdPerlengkapanName.addEventListener('blur', () => {
              const val = tdPerlengkapanName.textContent.trim();
              if (!val) {
                alert('Nama perlengkapan tidak boleh kosong');
                tdPerlengkapanName.textContent = item.name;
                return;
              }
              item.name = val;
              saveData();
            });
            trPerlengkapan.appendChild(tdPerlengkapanName);
            
            // Kolom kosong untuk jadwal (perlengkapan tidak memiliki jadwal)
            const tdSchedule = document.createElement('td');
            trPerlengkapan.appendChild(tdSchedule);

            // Jumlah barang
            const tdQuantity = document.createElement('td');
            tdQuantity.contentEditable = "true";
            tdQuantity.textContent = item.quantity;
            tdQuantity.title = "Klik untuk edit jumlah barang (angka)";
            tdQuantity.addEventListener('blur', () => {
              const val = tdQuantity.textContent.trim();
              const num = parseInt(val);
              if (isNaN(num) || num < 1) {
                alert('Jumlah barang harus angka dan minimal 1');
                tdQuantity.textContent = item.quantity;
                return;
              }
              item.quantity = num;
              saveData();
              updateSummaryBoxes();
            });
            trPerlengkapan.appendChild(tdQuantity);

            // Jumlah biaya
            const tdAmount = document.createElement('td');
            tdAmount.contentEditable = "true";
            tdAmount.textContent = item.amount;
            tdAmount.title = "Klik untuk edit jumlah biaya (angka)";
            tdAmount.addEventListener('blur', () => {
              let val = tdAmount.textContent.trim().replace(/[^0-9]/g, '');
              let num = parseInt(val);
              if (isNaN(num) || num < 0) {
                alert('Jumlah (Rp) harus angka dan minimal 0');
                tdAmount.textContent = item.amount;
                return;
              }
              item.amount = num;
              tdAmount.textContent = num;
              saveData();
              updateSummaryBoxes();
            });
            trPerlengkapan.appendChild(tdAmount);

            // Status persiapan
            const tdStatus = document.createElement('td');
            const statusBtn = document.createElement('button');
            statusBtn.className = `status-btn ${item.ready ? 'ready' : 'not-ready'}`;
            statusBtn.title = item.ready ? 'Sudah siap' : 'Belum siap';
            statusBtn.addEventListener('click', () => {
              item.ready = !item.ready;
              statusBtn.className = `status-btn ${item.ready ? 'ready' : 'not-ready'}`;
              statusBtn.title = item.ready ? 'Sudah siap' : 'Belum siap';
              saveData();
            });
            tdStatus.appendChild(statusBtn);
            trPerlengkapan.appendChild(tdStatus);

            // Aksi hapus perlengkapan
            const tdAction = document.createElement('td');
            const btnRemove = document.createElement('button');
            btnRemove.innerHTML = '<i class="fas fa-trash"></i> Hapus';
            btnRemove.className = 'remove-btn';
            btnRemove.title = 'Hapus perlengkapan';
            btnRemove.addEventListener('click', e => {
              e.stopPropagation();
              if (confirm(`Hapus perlengkapan "${item.name}"?`)) {
                acara.perlengkapan.splice(perlengkapanIndex, 1);
                saveData();
                renderTable();
              }
            });
            tdAction.appendChild(btnRemove);
            trPerlengkapan.appendChild(tdAction);

            tbody.appendChild(trPerlengkapan);

            // Tambahkan event listeners untuk drag and drop
            trPerlengkapan.addEventListener('dragstart', handleDragStart);
            trPerlengkapan.addEventListener('dragover', handleDragOver);
            trPerlengkapan.addEventListener('dragleave', handleDragLeave);
            trPerlengkapan.addEventListener('drop', handleDrop);
            trPerlengkapan.addEventListener('dragend', handleDragEnd);
          });
        });
        
        updateSummaryBoxes();
      }

      // Event tambah perlengkapan
      form.addEventListener('submit', e => {
        e.preventDefault();

        const acaraName = acaraInput.value.trim();
        const perlengkapanName = perlengkapanInput.value.trim();
        const quantity = parseInt(quantityInput.value);
        const amount = parseInt(amountInput.value);
        const eventDate = eventDateInput.value;
        const eventTime = eventTimeInput.value;

        if (!acaraName) {
          alert('Nama acara harus diisi');
          return;
        }
        if (!perlengkapanName) {
          alert('Perlengkapan harus diisi');
          return;
        }
        if (isNaN(quantity) || quantity < 1) {
          alert('Jumlah barang harus angka dan minimal 1');
          return;
        }
        if (isNaN(amount) || amount < 0) {
          alert('Jumlah (Rp) harus angka dan minimal 0');
          return;
        }
        if (!eventDate) {
          alert('Tanggal acara harus diisi');
          return;
        }

        // Cari acara, buat baru jika belum ada
        let acara = acaraList.find(a => a.name.toLowerCase() === acaraName.toLowerCase());
        if (!acara) {
          acara = { 
            name: acaraName, 
            date: eventDate,
            time: eventTime || '12:00',
            perlengkapan: []
          };
          acaraList.push(acara);
          // Tambahkan ke daftar autocomplete
          const option = document.createElement('option');
          option.value = acaraName;
          acaraDatalist.appendChild(option);
        }

        acara.perlengkapan.push({ 
          name: perlengkapanName, 
          quantity, 
          amount,
          ready: false // Status awal: belum siap
        });

        saveData();
        renderTable();

        // Reset form
        form.reset();
        acaraInput.focus();
        eventDateInput.value = '';
        eventTimeInput.value = '';
      });

      // Event listeners untuk tombol data
      saveDataBtn.addEventListener('click', saveData);
      loadDataBtn.addEventListener('click', loadData);
      resetDataBtn.addEventListener('click', resetData);

      // Export to PDF (simplified)
      exportPdfBtn.addEventListener('click', () => {
        if (acaraList.length === 0) {
          showNotification('Tidak ada data untuk diexport', true);
          return;
        }
        
        // Simulate PDF export
        showNotification('Export PDF sedang diproses...');
        setTimeout(() => {
          showNotification('Export PDF berhasil!');
        }, 2000);
      });

      // Fungsi untuk export ke Excel
      function exportToExcel() {
        if (acaraList.length === 0) {
          showNotification('Tidak ada data untuk diexport', true);
          return;
        }
        
        try {
          // Membuat workbook baru
          const wb = XLSX.utils.book_new();
          wb.Props = {
            Title: "Budget Pernikahan Panda",
            Subject: "Data Anggaran Pernikahan",
            Author: "Panda Wedding Planner",
            CreatedDate: new Date()
          };
          
          // Membuat sheet untuk ringkasan
          const summaryData = [
            ["RINGKASAN ANGGARAN PERNIKAHAN"],
            ["Total Acara", acaraList.length],
            ["Total Perlengkapan", acaraList.reduce((total, acara) => total + acara.perlengkapan.length, 0)],
            ["Total Anggaran", formatRupiah(acaraList.reduce((total, acara) => 
              total + acara.perlengkapan.reduce((sum, item) => sum + item.amount, 0), 0))],
            [],
            ["DETAIL PER ACARA"]
          ];
          
          // Menambahkan data per acara ke ringkasan
          acaraList.forEach(acara => {
            const totalAcara = acara.perlengkapan.reduce((sum, item) => sum + item.amount, 0);
            summaryData.push([acara.name, formatRupiah(totalAcara)]);
          });
          
          const ws_summary = XLSX.utils.aoa_to_sheet(summaryData);
          XLSX.utils.book_append_sheet(wb, ws_summary, "Ringkasan");
          
          // Membuat sheet untuk setiap acara
          acaraList.forEach(acara => {
            const acaraData = [
              [acara.name.toUpperCase()],
              [`Tanggal: ${acara.date || '-'}`, `Waktu: ${acara.time || '-'}`],
              [],
              ["Perlengkapan", "Jumlah", "Biaya (Rp)", "Status"]
            ];
            
            acara.perlengkapan.forEach(item => {
              acaraData.push([
                item.name, 
                item.quantity, 
                item.amount,
                item.ready ? "Sudah Siap" : "Belum Siap"
              ]);
            });
            
            // Menambahkan total per acara
            const totalAcara = acara.perlengkapan.reduce((sum, item) => sum + item.amount, 0);
            acaraData.push([], ["TOTAL ACARA", "", formatRupiah(totalAcara), ""]);
            
            const ws_acara = XLSX.utils.aoa_to_sheet(acaraData);
            XLSX.utils.book_append_sheet(wb, ws_acara, acara.name.substring(0, 30));
          });
          
          // Mengekspor file Excel
          const fileName = `Budget_Pernikahan_${new Date().toISOString().slice(0, 10)}.xlsx`;
          XLSX.writeFile(wb, fileName);
          
          showNotification('Data berhasil diexport ke Excel!');
        } catch (e) {
          showNotification('Gagal mengekspor data: ' + e.message, true);
        }
      }
      
      // Event listener untuk tombol export Excel
      exportExcelBtn.addEventListener('click', exportToExcel);

      // Login functionality
      loginBtn.addEventListener('click', () => {
        // Login langsung tanpa username/password
        currentUser = 'pandajawa';
        userNameEl.textContent = currentUser;
        
        // Hide login, show app
        loginContainer.style.display = 'none';
        mainApp.style.display = 'block';
        
        // Load user data
        loadData();
        
        // Set default date
        const today = new Date();
        const formattedDate = today.toISOString().split('T')[0];
        eventDateInput.value = formattedDate;
        eventTimeInput.value = '12:00';
        
        showNotification('Login berhasil! Selamat datang, pandajawa');
      });

      // Logout functionality
      logoutBtn.addEventListener('click', () => {
        currentUser = null;
        acaraList.length = 0;
        mainApp.style.display = 'none';
        loginContainer.style.display = 'block';
        showNotification('Anda telah logout');
      });

      // Theme toggle
      themeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        const isDarkMode = document.body.classList.contains('dark-mode');
        themeToggle.innerHTML = isDarkMode ? 
          '<i class="fas fa-sun"></i>' : 
          '<i class="fas fa-moon"></i>';
        
        // Save theme preference
        localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
      });

      // Apply saved theme
      window.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
          document.body.classList.add('dark-mode');
          themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        } else {
          themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
        }
      });
    })();
  </script>
</body>
</html>
